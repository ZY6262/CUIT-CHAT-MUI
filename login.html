<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<script src="js/mui.min.js"></script>

		<link rel="stylesheet" type="text/css" href="css/registLogin/util.css">
		<link rel="stylesheet" type="text/css" href="css/registLogin/main.css">

		<script type="text/javascript" charset="utf-8">
			mui.init();
		</script>

		<style>
			.p-t-85 {
				padding-top: 10px;
			}
			
			.p-b-70 {
				padding-bottom: 35px;
			}
			
			.m-t-85 {
				margin-top: 15px;
			}
			
			.container-login100 {
				padding: 25px;
			}
			/*toast信息提示*/
			
			.mui-toast-container {
				bottom: 50% !important;
			}
			.mui-toast-message {
				opacity: 0.6;
				color: #fff;
				width: 180px;
				padding: 70px 5px 10px 5px;
			}
		</style>
	</head>

	<body>

		<div class="mui-content">
			<div class="container-login100">
				<div class="wrap-login100 p-t-85 p-b-20">
					<form id="userform">
						<span class="login100-form-avatar">
							<img id="img_login_face" src="image/cuit.jpg" style="">
						</span>
						<span class="login100-form-title p-b-70">
							<h5 style="color: #015ca0;">cuit-chat</h5>
						</span>
						

						<div class="wrap-input100 validate-input m-t-85 m-b-35">
							<input class="input100" type="text" id="username" name="username" placeholder="用户名">
							<span class="focus-input100"></span>
						</div>

						<div class="wrap-input100 validate-input m-b-50">
							<input class="input100" type="password" id="txt_password" name="password" placeholder="密码">
							<span class="focus-input100"></span>
						</div>
						<div style="padding-top: 5px;" class="container-login100-form-btn">
							<button type="submit" class="login100-form-btn" id="login">
								登录
							</button>
						</div>
					</form>
				</div>
				<div class="otherOptions" style="position: relative; bottom: 5%; text-align: center; font-size: 14px;">
					<span style="color: #1973ba;">忘记密码</span>
					<span style="color: #1973ba;">&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;</span>
					<span class="register" style="color: #1973ba;">用户注册</span>
				</div>
			</div>
			
		</div>
		<script type="text/javascript" src="js/app.js"></script>
		<script type="text/javascript" src="js/myserver.js" ></script>
		<script type="text/javascript">
			
						
			mui.plusReady(function() {
				
				plus.navigator.setStatusBarBackground("#1973ba");
				plus.navigator.setStatusBarStyle("light");
				
				// 网络检查
				if (plus.networkinfo.getCurrentType() == plus.networkinfo.CONNECTION_NONE 
					|| plus.networkinfo.getCurrentType() == plus.networkinfo.CONNECTION_UNKNOW){
					app.showToast('当前网络连接出现了问题', 'error');
					return false;
				}
				
				var username = document.getElementById("username");
				var userform = document.getElementById("userform");
				var txt_pwd = document.getElementById("txt_password");
				
				// 是否允许back
				if (!app.isNotNull(plus.webview.currentWebview().enableBack)){
					mui.back = function(){
						return false;
					};
				}
				
				// 自动登录
				var userinfo = app.getUserInfo();
				if(app.isNotNull(userinfo)){
					mui.openWindow({url: 'index.html', id: 'index.html',
						extras:{
							isLogin: true
						},
						show: {
							autoShow: false,//页面loaded事件发生后自动显示，默认为true
						},
						waiting: {
							autoShow: true, // 自动显示等待框，默认为true
							title: '正在加载...', // 等待对话框上显示的提示内容
						}
					});
				} else {
					myserver.loginOrRegister(userform, username, txt_pwd, "login");
				}
				
				// 监听器添加
				mui(".otherOptions").on('tap', '.register', function(){
					app.pageSwitch('register.html', null, true, 'zoom-fade-out');
				}) 
				
			})
		</script>

	</body>

</html>